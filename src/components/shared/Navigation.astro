---
import { t, getRoute, getLocaleFromPath } from '../../scripts/i18n';

const locale = getLocaleFromPath(Astro.url.pathname);
const currentPath = Astro.url.pathname;

// Helper para determinar si una ruta est√° activa
function isActive(route: string): boolean {
  // Check if it's a home route (just locale or root)
  const isHomeRoute = route === '/' || route.match(/^\/[a-z]{2}(-[A-Z]{2})?\/$/);

  if (isHomeRoute) {
    return currentPath === route || currentPath === route.replace(/\/$/, '');
  }

  // For other routes, check if current path starts with the route
  // but make sure it's not just the locale prefix
  return currentPath.startsWith(route) && currentPath !== route.split('/').slice(0, 2).join('/') + '/';
}

const navItems = [
  { label: t(locale, 'nav.alarm'), route: getRoute(locale, 'home') },
  { label: t(locale, 'nav.timer'), route: getRoute(locale, 'timer') },
  { label: t(locale, 'nav.stopwatch'), route: getRoute(locale, 'stopwatch') },
  { label: t(locale, 'nav.clock'), route: getRoute(locale, 'clock') },
];
---

<ul class="flex flex-col md:flex-row md:space-x-6 space-y-2 md:space-y-0">
  {navItems.map(({ label, route }) => (
    <li>
      <a
        href={route}
        class={`
          block px-3 py-2 rounded-lg text-sm font-medium transition-colors
          ${
            isActive(route)
              ? 'bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300'
              : 'text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800'
          }
        `}
      >
        {label}
      </a>
    </li>
  ))}
</ul>
