---
/**
 * SEO Pages for City Time (Spanish)
 * Generates static pages for each city
 * Example: /es/hora/tokyo/, /es/hora/london/, /es/hora/new-york/
 */

import BaseLayout from '../../../layouts/BaseLayout.astro';
import timezonesData from '../../../data/timezones.json';

// Generate all possible city pages
export async function getStaticPaths() {
  return timezonesData.map(city => ({
    params: { city: city.id },
  }));
}

const { city: cityId } = Astro.params;

const cityData = timezonesData.find(tz => tz.id === cityId);

if (!cityData) {
  return Astro.redirect('/es/reloj-mundial/');
}

// Calculate current time in this timezone
const currentTime = new Date().toLocaleString('es-ES', {
  timeZone: cityData.timezone,
  hour: 'numeric',
  minute: '2-digit',
  hour12: true,
});

const currentDate = new Date().toLocaleString('es-ES', {
  timeZone: cityData.timezone,
  weekday: 'long',
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});

const title = `Hora Actual en ${cityData.name}, ${cityData.country} - Reloj Mundial`;
const description = `쯈u칠 hora es en ${cityData.name}? Consulta la hora local actual en ${cityData.name}, ${cityData.country}. Ve la zona horaria, diferencia UTC y diferencia de hora desde tu ubicaci칩n.`;
const keywords = `hora en ${cityData.name}, ${cityData.name} hora, ${cityData.country} hora, ${cityData.name} zona horaria, hora actual ${cityData.name}`;
---

<BaseLayout title={title} description={description} keywords={keywords}>
  <div class="container mx-auto px-4 py-12">
    <!-- Volver al Reloj Mundial -->
    <div class="mb-6">
      <a
        href="/es/reloj-mundial"
        class="inline-flex items-center text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors"
      >
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        Volver al Reloj Mundial
      </a>
    </div>

    <div class="text-center mb-12">
      <h1 class="text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-4">
        Hora Actual en {cityData.name}
      </h1>
      <p class="text-lg text-gray-600 dark:text-gray-400">
        {cityData.country}
      </p>
    </div>

    <!-- Live Clock -->
    <div class="max-w-2xl mx-auto mb-12">
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8">
        <div class="text-center mb-6">
          <div id="live-time" class="text-6xl md:text-7xl font-mono font-bold text-blue-600 dark:text-blue-400 mb-2">
            {currentTime}
          </div>
          <div id="live-date" class="text-lg text-gray-600 dark:text-gray-400">
            {currentDate}
          </div>
        </div>

        <div class="grid grid-cols-2 gap-4 text-center border-t border-gray-200 dark:border-gray-700 pt-6">
          <div>
            <div class="text-sm text-gray-600 dark:text-gray-400 mb-1">Zona Horaria</div>
            <div class="font-semibold text-gray-900 dark:text-white">{cityData.timezone}</div>
          </div>
          <div>
            <div class="text-sm text-gray-600 dark:text-gray-400 mb-1">Diferencia UTC</div>
            <div class="font-semibold text-gray-900 dark:text-white">{cityData.utcOffset}</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Information -->
    <div class="max-w-4xl mx-auto prose dark:prose-invert">
      <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">
        Acerca de la Hora en {cityData.name}
      </h2>

      <div class="space-y-4 text-gray-600 dark:text-gray-400">
        <p>
          La hora actual en <strong>{cityData.name}, {cityData.country}</strong> se muestra arriba.
          {cityData.name} est치 ubicada en la zona horaria {cityData.timezone} con una diferencia UTC de {cityData.utcOffset}.
        </p>

        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mt-6 mb-3">
          Informaci칩n de Zona Horaria
        </h3>
        <ul class="list-disc list-inside space-y-2">
          <li><strong>Ciudad:</strong> {cityData.name}</li>
          <li><strong>Pa칤s:</strong> {cityData.country}</li>
          <li><strong>Continente:</strong> {cityData.continent}</li>
          <li><strong>Zona Horaria:</strong> {cityData.timezone}</li>
          <li><strong>Diferencia UTC:</strong> {cityData.utcOffset}</li>
        </ul>

        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mt-6 mb-3">
          Cu치ndo Llamar a {cityData.name}
        </h3>
        <p>
          Si necesitas programar una llamada o reuni칩n con alguien en {cityData.name}, aseg칰rate de verificar
          la diferencia de hora actual entre tu ubicaci칩n y {cityData.name}. El mejor momento para llamar es
          t칤picamente durante las horas de oficina normales (9 AM - 5 PM) en la zona horaria local.
        </p>

        <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 mt-6">
          <p class="text-sm text-blue-900 dark:text-blue-100 mb-0">
            <strong>游눠 Consejo:</strong> Esta p치gina muestra la hora en vivo en {cityData.name}. El reloj se actualiza autom치ticamente
            cada segundo. Marca esta p치gina para acceso r치pido a la hora de {cityData.name}.
          </p>
        </div>
      </div>
    </div>
  </div>
</BaseLayout>

<script define:vars={{ timezone: cityData.timezone }}>
  // Update time every second
  function updateTime() {
    const now = new Date();

    const timeString = now.toLocaleString('es-ES', {
      timeZone: timezone,
      hour: 'numeric',
      minute: '2-digit',
      second: '2-digit',
      hour12: true,
    });

    const dateString = now.toLocaleString('es-ES', {
      timeZone: timezone,
      weekday: 'long',
      year: 'numeric',
      month: 'long',
      day: 'numeric',
    });

    const timeEl = document.getElementById('live-time');
    const dateEl = document.getElementById('live-date');

    if (timeEl) timeEl.textContent = timeString;
    if (dateEl) dateEl.textContent = dateString;
  }

  // Update immediately and then every second
  updateTime();
  setInterval(updateTime, 1000);
</script>
